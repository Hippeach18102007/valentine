<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ÄÄƒng nháº­p Valentine</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <style>
        /* Hiá»‡u á»©ng trÃ¡i tim Ä‘áº­p */
        @keyframes heartbeat {
            0% { transform: scale(1); }
            25% { transform: scale(1.1); }
            50% { transform: scale(1); }
            75% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        .heart-beat { animation: heartbeat 1.5s infinite; }

        /* Hiá»‡u á»©ng má» dáº§n khi táº¯t mÃ n hÃ¬nh chÃ o */
        .fade-out { opacity: 0; pointer-events: none; transition: opacity 1s ease-out; }

        /* Giáº¥u Youtube Ä‘i (nhÆ°ng váº«n Ä‘á»ƒ nÃ³ tá»“n táº¡i Ä‘á»ƒ phÃ¡t tiáº¿ng) */
        #youtube-audio-iframe {
            position: absolute; width: 1px; height: 1px; top: -9999px; left: -9999px; opacity: 0; pointer-events: none;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-pink-200 via-red-200 to-pink-300 min-h-screen flex items-center justify-center relative overflow-hidden">

<div id="youtube-audio-iframe"></div>

<div id="welcome-screen" class="fixed inset-0 z-50 bg-pink-100 flex flex-col items-center justify-center text-center p-4">
    <div class="text-6xl mb-6 heart-beat">ğŸ’Œ</div>
    <h1 class="text-4xl md:text-5xl text-pink-600 mb-4" style="font-family: 'Dancing Script', cursive;">
        Love Story
    </h1>
    <p class="text-gray-500 mb-8">Äeo tai nghe Ä‘á»ƒ cáº£m nháº­n yÃªu thÆ°Æ¡ng...</p>

    <button id="btnStart" onclick="startExperience()" disabled
            class="px-8 py-3 bg-gray-400 text-white rounded-full font-bold text-lg shadow-lg transition transform opacity-50 cursor-not-allowed">
        â³ Äang chuáº©n bá»‹ trÃ¡i tim...
    </button>
</div>

<div class="bg-white/80 backdrop-blur-md p-8 rounded-2xl shadow-2xl w-96 text-center border-4 border-white/50 relative z-10">
    <div class="text-6xl mb-4 text-pink-500">ğŸ’–</div>
    <h1 class="text-4xl text-pink-600 mb-2" style="font-family: 'Dancing Script', cursive;">ÄÄƒng Nháº­p</h1>

    <p class="text-gray-500 mb-6 text-sm">Nháº­p email Ä‘á»ƒ gá»­i lá»i yÃªu thÆ°Æ¡ng</p>

    <form action="/login" method="post" class="space-y-4">
        <input type="email" name="userEmail" required placeholder="example@gmail.com"
               class="w-full px-4 py-3 border border-pink-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-pink-400 bg-pink-50 placeholder-pink-300 text-pink-700">

        <button type="submit"
                class="w-full bg-gradient-to-r from-pink-500 to-red-500 text-white py-3 rounded-xl hover:shadow-lg hover:scale-105 transition transform font-bold">
            VÃ o tim anh/em â¤ï¸
        </button>
    </form>

    <div onclick="toggleYouTube()" class="mt-4 text-xs text-gray-400 cursor-pointer hover:text-pink-500 select-none">
        <span id="music-status">ğŸµ Äang phÃ¡t nháº¡c...</span>
    </div>
</div>

<script>
    // --- PHáº¦N 1: Cáº¥u hÃ¬nh Youtube ---
    var tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    var player;
    var btnStart = document.getElementById("btnStart");
    var welcomeScreen = document.getElementById("welcome-screen");
    var musicStatus = document.getElementById("music-status");
    var isPlaying = false;

    // ğŸ‘‡ ID bÃ i hÃ¡t (River Flows in You)
    var songId = '7maJOI3QMu0';

    function onYouTubeIframeAPIReady() {
        player = new YT.Player('youtube-audio-iframe', {
            height: '1', width: '1',
            videoId: songId,
            playerVars: {
                'autoplay': 0,      // KhÃ´ng tá»± cháº¡y, chá» báº¥m nÃºt
                'controls': 0,
                'loop': 1,          // Láº·p láº¡i
                'playlist': songId, // Báº¯t buá»™c Ä‘á»ƒ loop
                'origin': window.location.origin // Sá»­a lá»—i local
            },
            events: {
                'onReady': onPlayerReady,
                'onStateChange': onPlayerStateChange
            }
        });
    }

    // --- PHáº¦N 2: Xá»­ lÃ½ khi Nháº¡c Ä‘Ã£ táº£i xong ---
    function onPlayerReady(event) {
        // LÃºc nÃ y nháº¡c Ä‘Ã£ sáºµn sÃ ng -> Má»Ÿ khÃ³a nÃºt báº¥m
        btnStart.disabled = false;
        btnStart.innerText = "Má»Ÿ CÃ¡nh Cá»­a TrÃ¡i Tim â¤ï¸";

        // Äá»•i mÃ u nÃºt sang mÃ u há»“ng Ä‘áº¹p
        btnStart.classList.remove("bg-gray-400", "opacity-50", "cursor-not-allowed");
        btnStart.classList.add("bg-gradient-to-r", "from-pink-500", "to-red-500", "hover:scale-110", "animate-bounce");

        player.setVolume(50);
    }

    // --- PHáº¦N 3: Xá»­ lÃ½ khi Báº¤M NÃšT (Quan trá»ng nháº¥t) ---
    function startExperience() {
        if (!player) return;

        // 1. Ra lá»‡nh phÃ¡t nháº¡c NGAY Láº¬P Tá»¨C
        player.playVideo();
        isPlaying = true;
        musicStatus.innerText = "ğŸµ Äang phÃ¡t nháº¡c... (Báº¥m Ä‘á»ƒ táº¯t)";

        // 2. áº¨n mÃ n hÃ¬nh chÃ o Ä‘i
        welcomeScreen.classList.add("fade-out");
        setTimeout(() => { welcomeScreen.style.display = 'none'; }, 1000);
    }

    // Xá»­ lÃ½ loop (láº·p láº¡i)
    function onPlayerStateChange(event) {
        if (event.data === YT.PlayerState.ENDED) {
            player.playVideo();
        }
    }

    // NÃºt táº¯t/báº­t thá»§ cÃ´ng bÃªn trong
    function toggleYouTube() {
        if (!player) return;
        if (isPlaying) {
            player.pauseVideo();
            isPlaying = false;
            musicStatus.innerText = "ğŸ”‡ Nháº¡c Ä‘Ã£ táº¯t (Báº¥m Ä‘á»ƒ báº­t)";
        } else {
            player.playVideo();
            isPlaying = true;
            musicStatus.innerText = "ğŸµ Äang phÃ¡t nháº¡c... (Báº¥m Ä‘á»ƒ táº¯t)";
        }
    }
</script>
</body>
</html>